
=====================================
2021-05-23 12:23:35 0x7f6cc80c2700 INNODB MONITOR OUTPUT
=====================================
Per second averages calculated from the last 3 seconds
-----------------
BACKGROUND THREAD
-----------------
srv_master_thread loops: 70 srv_active, 0 srv_shutdown, 43042 srv_idle
srv_master_thread log flush and writes: 0
----------
SEMAPHORES
----------
OS WAIT ARRAY INFO: reservation count 186
OS WAIT ARRAY INFO: signal count 182
RW-shared spins 7, rounds 8, OS waits 2
RW-excl spins 46, rounds 630, OS waits 15
RW-sx spins 1, rounds 5, OS waits 0
Spin rounds per wait: 1.14 RW-shared, 13.70 RW-excl, 5.00 RW-sx
------------------------
LATEST DETECTED DEADLOCK
------------------------
2021-05-23 11:40:10 0x7f6cc80c2700
*** (1) TRANSACTION:
TRANSACTION 19237, ACTIVE 12 sec inserting
mysql tables in use 1, locked 1
LOCK WAIT 3 lock struct(s), heap size 1136, 2 row lock(s), undo log entries 1
MySQL thread id 34, OS thread handle 140105189144320, query id 905 172.17.0.1 root update
insert into test_dup(num,name) values(40,'no') on duplicate key update name='dcdcdf4738'
*** (1) WAITING FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 56 page no 5 n bits 72 index num_index of table `deadlock`.`test_dup` trx id 19237 lock_mode X locks gap before rec insert intention waiting
Record lock, heap no 2 PHYSICAL RECORD: n_fields 2; compact format; info bits 0
0: len 4; hex 00000029; asc    );;
1: len 4; hex 8000008a; asc     ;;

*** (2) TRANSACTION:
TRANSACTION 19236, ACTIVE 13 sec inserting
mysql tables in use 1, locked 1
5 lock struct(s), heap size 1136, 4 row lock(s), undo log entries 2
MySQL thread id 33, OS thread handle 140105189435136, query id 906 172.17.0.1 root update
insert into test_dup(num,name) values(38,'no') on duplicate key update name='dcdcdf4738'
*** (2) HOLDS THE LOCK(S):
RECORD LOCKS space id 56 page no 5 n bits 72 index num_index of table `deadlock`.`test_dup` trx id 19236 lock_mode X locks gap before rec
Record lock, heap no 2 PHYSICAL RECORD: n_fields 2; compact format; info bits 0
0: len 4; hex 00000029; asc    );;
1: len 4; hex 8000008a; asc     ;;

*** (2) WAITING FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 56 page no 5 n bits 72 index num_index of table `deadlock`.`test_dup` trx id 19236 lock_mode X locks gap before rec insert intention waiting
Record lock, heap no 2 PHYSICAL RECORD: n_fields 2; compact format; info bits 0
0: len 4; hex 00000029; asc    );;
1: len 4; hex 8000008a; asc     ;;

*** WE ROLL BACK TRANSACTION (1)
------------
TRANSACTIONS
------------
Trx id counter 19338
Purge done for trx's n:o < 19336 undo n:o < 0 state: running but idle
History list length 11
LIST OF TRANSACTIONS FOR EACH SESSION:
---TRANSACTION 421580736225872, not started
0 lock struct(s), heap size 1136, 0 row lock(s)
---TRANSACTION 19337, ACTIVE 12 sec inserting
mysql tables in use 1, locked 1
LOCK WAIT 3 lock struct(s), heap size 1136, 2 row lock(s), undo log entries 1
MySQL thread id 37, OS thread handle 140105189144320, query id 1042 172.17.0.1 root update
insert into t values(60,35,62,63) on duplicate key update c2=35
------- TRX HAS BEEN WAITING 12 SEC FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 59 page no 5 n bits 72 index i_c2 of table `deadlock`.`t` trx id 19337 lock_mode X locks gap before rec insert intention waiting
Record lock, heap no 6 PHYSICAL RECORD: n_fields 2; compact format; info bits 0
0: len 4; hex 80000024; asc    $;;
1: len 4; hex 80000032; asc    2;;

------------------
TABLE LOCK table `deadlock`.`t` trx id 19337 lock mode IX
RECORD LOCKS space id 59 page no 5 n bits 72 index i_c2 of table `deadlock`.`t` trx id 19337 lock_mode X locks gap before rec
Record lock, heap no 6 PHYSICAL RECORD: n_fields 2; compact format; info bits 0
0: len 4; hex 80000024; asc    $;;
1: len 4; hex 80000032; asc    2;;

RECORD LOCKS space id 59 page no 5 n bits 72 index i_c2 of table `deadlock`.`t` trx id 19337 lock_mode X locks gap before rec insert intention waiting
Record lock, heap no 6 PHYSICAL RECORD: n_fields 2; compact format; info bits 0
0: len 4; hex 80000024; asc    $;;
1: len 4; hex 80000032; asc    2;;

---TRANSACTION 19336, ACTIVE 13 sec
3 lock struct(s), heap size 1136, 3 row lock(s), undo log entries 1
MySQL thread id 36, OS thread handle 140105592006400, query id 1040 172.17.0.1 root
TABLE LOCK table `deadlock`.`t` trx id 19336 lock mode IX
RECORD LOCKS space id 59 page no 5 n bits 72 index i_c2 of table `deadlock`.`t` trx id 19336 lock_mode X locks gap before rec
Record lock, heap no 5 PHYSICAL RECORD: n_fields 2; compact format; info bits 0
0: len 4; hex 80000029; asc    );;
1: len 4; hex 80000028; asc    (;;

Record lock, heap no 6 PHYSICAL RECORD: n_fields 2; compact format; info bits 0
0: len 4; hex 80000024; asc    $;;
1: len 4; hex 80000032; asc    2;;

RECORD LOCKS space id 59 page no 5 n bits 72 index i_c2 of table `deadlock`.`t` trx id 19336 lock_mode X locks rec but not gap
Record lock, heap no 6 PHYSICAL RECORD: n_fields 2; compact format; info bits 0
0: len 4; hex 80000024; asc    $;;
1: len 4; hex 80000032; asc    2;;

--------
FILE I/O
--------
I/O thread 0 state: waiting for completed aio requests (insert buffer thread)
I/O thread 1 state: waiting for completed aio requests (log thread)
I/O thread 2 state: waiting for completed aio requests (read thread)
I/O thread 3 state: waiting for completed aio requests (read thread)
I/O thread 4 state: waiting for completed aio requests (read thread)
I/O thread 5 state: waiting for completed aio requests (read thread)
I/O thread 6 state: waiting for completed aio requests (write thread)
I/O thread 7 state: waiting for completed aio requests (write thread)
I/O thread 8 state: waiting for completed aio requests (write thread)
I/O thread 9 state: waiting for completed aio requests (write thread)
Pending normal aio reads: [0, 0, 0, 0] , aio writes: [0, 0, 0, 0] ,
ibuf aio reads:, log i/o's:, sync i/o's:
Pending flushes (fsync) log: 0; buffer pool: 0
1003 OS file reads, 3070 OS file writes, 1304 OS fsyncs
0.00 reads/s, 0 avg bytes/read, 0.00 writes/s, 0.00 fsyncs/s
-------------------------------------
INSERT BUFFER AND ADAPTIVE HASH INDEX
-------------------------------------
Ibuf: size 1, free list len 0, seg size 2, 0 merges
merged operations:
insert 0, delete mark 0, delete 0
discarded operations:
insert 0, delete mark 0, delete 0
Hash table size 34679, node heap has 1 buffer(s)
Hash table size 34679, node heap has 2 buffer(s)
Hash table size 34679, node heap has 5 buffer(s)
Hash table size 34679, node heap has 0 buffer(s)
Hash table size 34679, node heap has 2 buffer(s)
Hash table size 34679, node heap has 1 buffer(s)
Hash table size 34679, node heap has 0 buffer(s)
Hash table size 34679, node heap has 0 buffer(s)
0.00 hash searches/s, 0.00 non-hash searches/s
---
LOG
---
Log sequence number          84769673
Log buffer assigned up to    84769673
Log buffer completed up to   84769673
Log written up to            84769673
Log flushed up to            84769673
Added dirty pages up to      84769673
Pages flushed up to          84769673
Last checkpoint at           84769673
963 log i/o's done, 0.00 log i/o's/second
----------------------
BUFFER POOL AND MEMORY
----------------------
Total large memory allocated 137428992
Dictionary memory allocated 439314
Buffer pool size   8192
Free buffers       6960
Database pages     1221
Old database pages 439
Modified db pages  0
Pending reads      0
Pending writes: LRU 0, flush list 0, single page 0
Pages made young 0, not young 0
0.00 youngs/s, 0.00 non-youngs/s
Pages read 980, created 241, written 1792
0.00 reads/s, 0.00 creates/s, 0.00 writes/s
Buffer pool hit rate 1000 / 1000, young-making rate 0 / 1000 not 0 / 1000
Pages read ahead 0.00/s, evicted without access 0.00/s, Random read ahead 0.00/s
LRU len: 1221, unzip_LRU len: 0
I/O sum[0]:cur[0], unzip sum[0]:cur[0]
--------------
ROW OPERATIONS
--------------
0 queries inside InnoDB, 0 queries in queue
0 read views open inside InnoDB
Process ID=1, Main thread ID=140105252476672 , state=sleeping
Number of rows inserted 236, updated 516, deleted 151, read 13677
0.00 inserts/s, 0.00 updates/s, 0.00 deletes/s, 0.00 reads/s
----------------------------
END OF INNODB MONITOR OUTPUT
============================
